!function(a){function b(b,c){var d=this;this.config=a.extend({},this.defaults(),c),""!==this.config.auto_assign&&a(b).find(this.config.auto_assign).each(function(){return a(this).parent().is("pre")?void(this.hasAttribute("class")&&a(this).parent().addClass("lang-"+a(this).attr("class"))):void a(this).addClass("prettyprint")}),a(".prettyprint").each(function(){d.prettify(this)})}a.fn.extend({mivhak:function(a){return this.each(function(){new b(this,a)})}}),b.prototype.prettify=function(b){if("CODE"!==b.tagName){var c=this.config,d=this.getLang(b),e=parseInt(b.getAttribute("data-start-line"))||1,f=b.getAttribute("data-visibility"),g=b.getAttribute("data-highlight"),h=b.getAttribute("data-caption"),i=a("<div>").addClass("mivhak-code-wrapper"),j=ace.edit(b);if(c.line_numbers||(j.renderer.setShowGutter(!1),j.getSession().on("changeScrollLeft",function(){j.getSession().setScrollLeft(0)})),i=a(b).wrap(i).parent(),"hidden"===f){var k=a("<div>").addClass("mivhak-visibility-toggle").text(this.config.i18n[5]).click(function(){var c=a(b).outerHeight()+30;i.toggleClass("mivhak-hidden").css({height:c+"px"})});i.append(k).addClass("mivhak-hidden")}c.show_meta&&j.session.getLength()>=c.min_lines&&a(b).before(this.buildHeader(b,j,d)),null!==h&&""!==h&&a(b).after(a("<div></div>").addClass("caption-text").text(h)),null!==g&&""!==g&&this.highlightLines(j,g),ace.config.set("basePath","https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/"),j.setReadOnly(!0),j.setTheme("ace/theme/"+c.theme),j.getSession().setMode("ace/mode/"+d),j.getSession().setUseWorker(!1),j.setOptions({maxLines:1/0,firstLineNumber:e,highlightActiveLine:!1,fontSize:parseInt(c.font_size)})}},b.prototype.defaults=function(){return{auto_assign:!1,show_meta:!1,line_numbers:!1,min_lines:2,font_size:12,theme:"twilight",default_lang:"text",lang_list:{}}},b.prototype.buttons=function(){return[{description:this.config.i18n[2],"class":"mivhak-icon copy-icon",func:function(a,b){b.hasClass("active")?a.selection.clearSelection():(a.selection.selectAll(),a.focus()),b.toggleClass("active")}},{description:this.config.i18n[3],"class":"mivhak-icon expand-icon",func:function(b){var c=window.open("","","width=500,height=330,resizable=1");b.selection.selectAll();var d=b.session.getTextRange(b.getSelectionRange());c.document.write("<pre>"+a("<div/>").text(d).html()+"</pre>"),b.selection.clearSelection()}},{description:this.config.i18n[4],"class":"mivhak-icon wrap-icon",func:function(a,b){b.hasClass("active")?a.getSession().setUseWrapMode(!1):a.getSession().setUseWrapMode(!0),b.toggleClass("active")}},{description:this.config.i18n[6],"class":"mivhak-icon info-icon",func:function(b,c){var d=a("<div>",{"class":"mivhak-info"}).html('<a href="https://wordpress.org/plugins/mivhak/">Mivhak Syntax Highlighter</a> v'+mivhak_settings.version);c.hasClass("active")?c.find(".mivhak-info").remove():c.append(d),c.toggleClass("active")}}]},b.prototype.buildHeader=function(b,c){var d=a("<div>",{"class":"meta"}),e=a("<div>",{"class":"text"}),f=a("<div>",{"class":"control"}),g=a("<div>",{"class":"lang"}),h=a("<div>",{"class":"info"}),i=this.getLang(b);return null!==i&&(g.html(this.config.lang_list[i]),d.append(g)),f.append(this.generateButtons(c)),e.html(c.session.getLength()+" "+this.config.i18n[1]),h.html("<h3>Mivhak Syntax Highlighter</h3>"),d.append(e,f),d},b.prototype.generateButtons=function(b){var c=[];return a.each(this.buttons(),function(){var d=a("<div>",{title:this.description}),e=a("<i>",{"class":this["class"]}),f=this.func;d.append(e),d.click(function(){f(b,d)}),c.push(d)}),c},b.prototype.getLang=function(a){var b=a.className.match(/lang-([^ ]+)/g);return null===b?""!==this.config.default_lang?this.config.default_lang:null:b[0].split("-")[1]},b.prototype.highlightLines=function(b,c){var d=ace.require("ace/range").Range;c=c.replace(" ",""),a(c.split(",")).each(function(){var a,c;this.indexOf("-")>-1?(a=parseInt(this.split("-")[0])-1,c=parseInt(this.split("-")[1])-1):(a=parseInt(this)-1,c=a),b.session.addMarker(new d(a,0,c,1),"ace_active-line","fullLine")})},a(document).mivhak(typeof mivhak_settings === 'undefined' ? {} : mivhak_settings)}(window.jQuery);